{
  "metadata": {
    "title": "OSCAL SSP Validation Rules",
    "version": "1.0",
    "created": "2025-12-17",
    "description": "Validation rules extracted from FedRAMP Schematron for OSCAL SSPs",
    "source": "fedramp-automation/src/validations/rules/rev5/ssp.sch",
    "basis": "NIST 800-18 SSP requirements mapped to OSCAL elements"
  },
  "statistics": {
    "total_rules": 28,
    "error_rules": 26,
    "warning_rules": 2
  },
  "rules": [
    {
      "rule_id": "has-system-id",
      "nist_section": "3.1",
      "nist_title": "System Name and Identifier",
      "oscal_element": "system-id",
      "oscal_xpath": "//system-security-plan/system-characteristics/system-id",
      "test_expression": "oscal:system-id[@identifier-type eq 'https://fedramp.gov']",
      "message": "A FedRAMP SSP must have a FedRAMP system identifier",
      "severity": "error",
      "guide_reference": "Guide to OSCAL-based FedRAMP System Security Plans \u00a74.1.2",
      "required": true
    },
    {
      "rule_id": "has-active-system-id",
      "nist_section": "3.1",
      "nist_title": "System Name and Identifier",
      "oscal_element": "system-id",
      "oscal_xpath": "//system-security-plan/system-characteristics/system-id",
      "test_expression": "Active system ID validation against FedRAMP data registry",
      "message": "A FedRAMP SSP must have an active FedRAMP system identifier",
      "severity": "error",
      "guide_reference": "",
      "required": true
    },
    {
      "rule_id": "has-system-name",
      "nist_section": "3.1",
      "nist_title": "System Name and Identifier",
      "oscal_element": "system-name",
      "oscal_xpath": "//system-security-plan/system-characteristics/system-name",
      "test_expression": "oscal:system-name",
      "message": "A FedRAMP SSP must have a system name",
      "severity": "error",
      "guide_reference": "Guide to OSCAL-based FedRAMP System Security Plans \u00a74.1.2",
      "required": true
    },
    {
      "rule_id": "has-system-name-short",
      "nist_section": "3.1",
      "nist_title": "System Name and Identifier",
      "oscal_element": "system-name-short",
      "oscal_xpath": "//system-security-plan/system-characteristics/system-name-short",
      "test_expression": "oscal:system-name-short",
      "message": "A FedRAMP SSP must have a short system name",
      "severity": "error",
      "guide_reference": "Guide to OSCAL-based FedRAMP System Security Plans \u00a74.1.2",
      "required": true
    },
    {
      "rule_id": "has-security-sensitivity-level",
      "nist_section": "3.2",
      "nist_title": "System Categorization",
      "oscal_element": "security-sensitivity-level",
      "oscal_xpath": "//system-security-plan/system-characteristics/security-sensitivity-level",
      "test_expression": "oscal:security-sensitivity-level",
      "message": "An OSCAL SSP document must specify a FIPS 199 categorization",
      "severity": "error",
      "guide_reference": "Guide to OSCAL-based FedRAMP System Security Plans \u00a74.1.2",
      "required": true
    },
    {
      "rule_id": "has-allowed-security-sensitivity-level",
      "nist_section": "3.2",
      "nist_title": "System Categorization",
      "oscal_element": "security-sensitivity-level",
      "oscal_xpath": "//system-security-plan/system-characteristics/security-sensitivity-level",
      "test_expression": "current() = $security-sensitivity-levels",
      "message": "A FedRAMP SSP must specify an allowed security sensitivity level",
      "severity": "error",
      "guide_reference": "",
      "required": true
    },
    {
      "rule_id": "security-sensitivity-level-matches-security-impact-level",
      "nist_section": "3.2",
      "nist_title": "System Categorization",
      "oscal_element": "security-sensitivity-level",
      "oscal_xpath": "//system-security-plan/system-characteristics/security-sensitivity-level",
      "test_expression": "Security sensitivity level must match highest security impact level",
      "message": "A FedRAMP SSP security sensitivity level must match the highest level within the security impact levels",
      "severity": "error",
      "guide_reference": "",
      "required": true
    },
    {
      "rule_id": "has-security-impact-level",
      "nist_section": "3.2",
      "nist_title": "System Categorization",
      "oscal_element": "security-impact-level",
      "oscal_xpath": "//system-security-plan/system-characteristics/security-impact-level",
      "test_expression": "oscal:security-impact-level",
      "message": "An OSCAL SSP document must specify a security impact level",
      "severity": "error",
      "guide_reference": "Guide to OSCAL-based FedRAMP System Security Plans \u00a74.1.2",
      "required": true
    },
    {
      "rule_id": "has-security-objective-confidentiality",
      "nist_section": "3.2",
      "nist_title": "System Categorization",
      "oscal_element": "security-impact-level",
      "oscal_xpath": "//system-security-plan/system-characteristics/security-impact-level",
      "test_expression": "oscal:security-objective-confidentiality",
      "message": "An OSCAL SSP must specify a confidentiality security objective",
      "severity": "error",
      "guide_reference": "",
      "required": true
    },
    {
      "rule_id": "has-security-objective-integrity",
      "nist_section": "3.2",
      "nist_title": "System Categorization",
      "oscal_element": "security-impact-level",
      "oscal_xpath": "//system-security-plan/system-characteristics/security-impact-level",
      "test_expression": "oscal:security-objective-integrity",
      "message": "An OSCAL SSP must specify an integrity security objective",
      "severity": "error",
      "guide_reference": "",
      "required": true
    },
    {
      "rule_id": "has-security-objective-availability",
      "nist_section": "3.2",
      "nist_title": "System Categorization",
      "oscal_element": "security-impact-level",
      "oscal_xpath": "//system-security-plan/system-characteristics/security-impact-level",
      "test_expression": "oscal:security-objective-availability",
      "message": "An OSCAL SSP must specify an availability security objective",
      "severity": "error",
      "guide_reference": "",
      "required": true
    },
    {
      "rule_id": "cia-impact-matches-security-objective",
      "nist_section": "3.2",
      "nist_title": "System Categorization",
      "oscal_element": "security-impact-level",
      "oscal_xpath": "//system-security-plan/system-characteristics/security-impact-level",
      "test_expression": "CIA impact values match information type impact elements",
      "message": "An SSP security objective value must be the same as highest available value of the same information type impact element",
      "severity": "warning",
      "guide_reference": "",
      "required": true
    },
    {
      "rule_id": "role-defined-system-owner",
      "nist_section": "3.3",
      "nist_title": "System Owner",
      "oscal_element": "role",
      "oscal_xpath": "//system-security-plan/metadata/role[@id='system-owner']",
      "test_expression": "oscal:role[@id eq 'system-owner']",
      "message": "The System Owner role must be defined",
      "severity": "error",
      "guide_reference": "Guide to OSCAL-based FedRAMP System Security Plans \u00a74.2",
      "required": true
    },
    {
      "rule_id": "role-has-responsible-party",
      "nist_section": "3.3",
      "nist_title": "System Owner",
      "oscal_element": "responsible-party",
      "oscal_xpath": "//system-security-plan/metadata/responsible-party[@role-id='system-owner']",
      "test_expression": "//oscal:responsible-party[@role-id eq current()/@id]",
      "message": "One or more responsible parties must be defined for each role",
      "severity": "error",
      "guide_reference": "",
      "required": true
    },
    {
      "rule_id": "responsible-party-has-party-uuid",
      "nist_section": "3.3",
      "nist_title": "System Owner",
      "oscal_element": "responsible-party",
      "oscal_xpath": "//system-security-plan/metadata/responsible-party[@role-id='system-owner']",
      "test_expression": "oscal:party-uuid",
      "message": "A responsible party must reference a party",
      "severity": "error",
      "guide_reference": "",
      "required": true
    },
    {
      "rule_id": "role-defined-authorizing-official",
      "nist_section": "3.4",
      "nist_title": "Authorizing Official",
      "oscal_element": "role",
      "oscal_xpath": "//system-security-plan/metadata/role[@id='authorizing-official']",
      "test_expression": "oscal:role[@id eq 'authorizing-official']",
      "message": "The Authorizing Official role must be defined",
      "severity": "error",
      "guide_reference": "Guide to OSCAL-based FedRAMP System Security Plans \u00a74.1.6",
      "required": true
    },
    {
      "rule_id": "role-defined-system-poc-management",
      "nist_section": "3.5",
      "nist_title": "Other Designated Contacts",
      "oscal_element": "role[@id='system-poc-management']",
      "oscal_xpath": "//system-security-plan/metadata/role[@id='system-poc-management']",
      "test_expression": "oscal:role[@id eq 'system-poc-management']",
      "message": "The System Management PoC role must be defined",
      "severity": "error",
      "guide_reference": "Guide to OSCAL-based FedRAMP System Security Plans \u00a74.1.6",
      "required": true
    },
    {
      "rule_id": "role-defined-system-poc-technical",
      "nist_section": "3.5",
      "nist_title": "Other Designated Contacts",
      "oscal_element": "role[@id='system-poc-technical']",
      "oscal_xpath": "//system-security-plan/metadata/role[@id='system-poc-technical']",
      "test_expression": "oscal:role[@id eq 'system-poc-technical']",
      "message": "The System Technical PoC role must be defined",
      "severity": "error",
      "guide_reference": "",
      "required": true
    },
    {
      "rule_id": "role-defined-system-poc-other",
      "nist_section": "3.5",
      "nist_title": "Other Designated Contacts",
      "oscal_element": "role[@id='system-poc-other']",
      "oscal_xpath": "//system-security-plan/metadata/role[@id='system-poc-other']",
      "test_expression": "oscal:role[@id eq 'system-poc-other']",
      "message": "The System Other PoC role must be defined",
      "severity": "error",
      "guide_reference": "",
      "required": true
    },
    {
      "rule_id": "role-defined-information-system-security-officer",
      "nist_section": "3.6",
      "nist_title": "Assignment of Security Responsibility",
      "oscal_element": "role[@id='information-system-security-officer']",
      "oscal_xpath": "//system-security-plan/metadata/role[@id='information-system-security-officer']",
      "test_expression": "oscal:role[@id eq 'information-system-security-officer']",
      "message": "The Information System Security Officer role must be defined",
      "severity": "error",
      "guide_reference": "Guide to OSCAL-based FedRAMP System Security Plans \u00a74.4",
      "required": true
    },
    {
      "rule_id": "system-information-has-information-type",
      "nist_section": "3.8",
      "nist_title": "Information System Type",
      "oscal_element": "system-information",
      "oscal_xpath": "//system-security-plan/system-characteristics/system-information",
      "test_expression": "oscal:information-type",
      "message": "An OSCAL SSP must define at least one information type",
      "severity": "error",
      "guide_reference": "Guide to OSCAL-based FedRAMP System Security Plans \u00a74.1.6",
      "required": true
    },
    {
      "rule_id": "information-type-has-title",
      "nist_section": "3.8",
      "nist_title": "Information System Type",
      "oscal_element": "information-type",
      "oscal_xpath": "//system-security-plan/system-characteristics/system-information/information-type",
      "test_expression": "oscal:title",
      "message": "An OSCAL SSP information type must have a title",
      "severity": "error",
      "guide_reference": "",
      "required": false
    },
    {
      "rule_id": "information-type-has-categorization",
      "nist_section": "3.8",
      "nist_title": "Information System Type",
      "oscal_element": "information-type",
      "oscal_xpath": "//system-security-plan/system-characteristics/system-information/information-type",
      "test_expression": "oscal:categorization",
      "message": "A FedRAMP SSP information type must have at least one categorization",
      "severity": "error",
      "guide_reference": "",
      "required": false
    },
    {
      "rule_id": "has-allowed-information-type-id",
      "nist_section": "3.8",
      "nist_title": "Information System Type",
      "oscal_element": "information-type",
      "oscal_xpath": "//system-security-plan/system-characteristics/system-information/information-type",
      "test_expression": "Information type ID must be from NIST SP 800-60v2r1",
      "message": "A FedRAMP SSP information type identifier must be chosen from those found in NIST SP 800-60v2r1",
      "severity": "error",
      "guide_reference": "",
      "required": false
    },
    {
      "rule_id": "has-system-description",
      "nist_section": "3.9",
      "nist_title": "General Description/Purpose",
      "oscal_element": "description",
      "oscal_xpath": "//system-security-plan/system-characteristics/description",
      "test_expression": "count(tokenize(normalize-space(oscal:description), '\\s+')) ge 32",
      "message": "A FedRAMP SSP must have a description at least 32 words in length",
      "severity": "error",
      "guide_reference": "Guide to OSCAL-based FedRAMP System Security Plans \u00a74.1.8",
      "required": true
    },
    {
      "rule_id": "has-this-system-component",
      "nist_section": "3.10",
      "nist_title": "System Environment",
      "oscal_element": "component[@type='this-system']",
      "oscal_xpath": "//system-security-plan/system-implementation/component[@type='this-system']",
      "test_expression": "exists(oscal:component[@type eq 'this-system'])",
      "message": "A FedRAMP SSP must have a self-referential (i.e., to the SSP itself) component",
      "severity": "error",
      "guide_reference": "Guide to OSCAL-based FedRAMP System Security Plans \u00a76.4.6",
      "required": true
    },
    {
      "rule_id": "FedRAMP-ATO-Identifier-exists",
      "nist_section": "3.11",
      "nist_title": "System Interconnection/Information Sharing",
      "oscal_element": "leveraged-authorization",
      "oscal_xpath": "//system-security-plan/system-implementation/leveraged-authorization",
      "test_expression": "oscal:prop[@ns eq 'https://fedramp.gov/ns/oscal' and @name eq 'leveraged-system-identifier']",
      "message": "A FedRAMP leveraged authorization must have an identifier",
      "severity": "warning",
      "guide_reference": "",
      "required": false
    },
    {
      "rule_id": "has-fedramp-authorization-type",
      "nist_section": "3.12",
      "nist_title": "Laws, Regulations, and Policies Affecting the System",
      "oscal_element": "prop[@ns='https://fedramp.gov/ns/oscal'][@name='authorization-type']",
      "oscal_xpath": "//system-security-plan/system-characteristics/prop[@name='authorization-type']",
      "test_expression": "oscal:prop[@ns eq 'https://fedramp.gov/ns/oscal' and @name eq 'authorization-type' and @value = $authorization-types]",
      "message": "A FedRAMP SSP must have an allowed FedRAMP authorization type",
      "severity": "error",
      "guide_reference": "Guide to OSCAL-based FedRAMP System Security Plans \u00a74.1.6",
      "required": true
    }
  ]
}